---
icon: simple/fastapi
---

# 03 CRUD: PUT e DELETE


``` python hl_lines="6" title="app.py"
from fastapi import FastAPI, HTTPException
from schemas import UserSchema, UserResponse, UserDB, UserList, UserPublic

...

@app.put('/users/{user_id}', response_model=UserPublic)
def update_user(user_id: int, user: UserSchema): # (1)!
    if user_id > len(database) or user_id < 1: # (2)!
        raise HTTPException( # (3)!
            status_code=404, detail='User not found'
        ) 

    user_with_id = UserDB(**user.model_dump(), id=user_id) # (4)!
    database[user_id - 1] = user_with_id # (5)!

    return user_with_id
```

1. O parâmetro `user_id`, que deve ser um número inteiro, identifica qual usuário deve ser atualizado, enquanto o parâmetro `user`, que segue o modelo `UserSchema`, contém os dados que serão utilizados na atualização. Assim, a função combina esses dois elementos para localizar e modificar as informações do usuário correspondente no banco de dados.   
2. Avalia se o identificador do usuário é maior que o número total de usuários no banco de dados ou menor que 1. Se qualquer uma dessas condições for verdadeira, a função gera uma exceção HTTP 404, utilizando `raise HTTPException`, indicando que o usuário não foi encontrado.
3. Esse trecho gera uma exceção HTTP 404, indicando que o usuário não foi encontrado. Ele utiliza `HTTPException` com `status_code=404` e a mensagem `detail='User not found'` para informar ao cliente que o recurso solicitado não existe.
4. Cria uma nova instância de `UserDB` usando os dados recebidos
5. Substitui o usuário existente no banco de dados. Aqui, `user_with_id` (a nova instância com os dados atualizados) é atribuído à posição correspondente a `user_id - 1` na lista database, substituindo quaisquer dados que estavam anteriormente nesse índice. O `-1` é usado para ajustar o índice porque a contagem em listas em Python começa do zero, enquanto os identificadores de usuário (neste caso, `user_id`) geralmente começam a partir de 1.